<div class="w-full bg-white">
  <div class="mx-auto max-w-7xl px-6 md:px-12 lg:px-20 py-16 md:py-20">
    <!-- Header -->
    <div class="text-center mb-12 md:mb-16">
      <h2 class="text-3xl md:text-4xl lg:text-5xl font-bold text-black mb-3 leading-tight">
        {{ section.settings.title }}
      </h2>
      <p class="text-gray-500 text-sm md:text-base">
        {{ section.settings.subtitle }}
      </p>
    </div>

    <!-- 3D Carousel Container -->
    <div class="flex justify-center items-center mb-12 md:mb-16" style="perspective: 1200px; height: 500px;">
      <div class="carousel-container relative w-full h-full flex items-center justify-center" style="transform-style: preserve-3d;">
        
        <!-- Item 1 -->
        <div class="carousel-item absolute w-32 md:w-40 h-40 md:h-56 rounded-lg cursor-pointer transition-all duration-700 overflow-hidden" data-index="0" style="transform-style: preserve-3d;">
          <div class="w-full h-full bg-stone-200 flex items-center justify-center text-center shadow-lg rounded-lg overflow-hidden">
            {% if section.settings.category_1_image != blank %}
              {{ section.settings.category_1_image | image_url: width: 400 | image_tag: alt: section.settings.category_1_label, class: 'w-full h-full object-cover', loading: 'lazy', width: 400, height: 400 }}
            {% else %}
              <div class="text-xs md:text-sm font-medium text-gray-700 px-4">
                {{ section.settings.category_1_label }}
              </div>
            {% endif %}
          </div>
        </div>

        <!-- Item 2 -->
        <div class="carousel-item absolute w-32 md:w-40 h-40 md:h-56 rounded-lg cursor-pointer transition-all duration-700 overflow-hidden" data-index="1" style="transform-style: preserve-3d;">
          <div class="w-full h-full bg-stone-200 flex items-center justify-center text-center shadow-lg rounded-lg overflow-hidden">
            {% if section.settings.category_2_image != blank %}
              {{ section.settings.category_2_image | image_url: width: 400 | image_tag: alt: section.settings.category_2_label, class: 'w-full h-full object-cover', loading: 'lazy', width: 400, height: 400 }}
            {% else %}
              <div class="text-xs md:text-sm font-medium text-gray-700 px-4">
                {{ section.settings.category_2_label }}
              </div>
            {% endif %}
          </div>
        </div>

        <!-- Item 3 - Featured -->
        <div class="carousel-item absolute w-40 md:w-56 h-56 md:h-80 rounded-lg cursor-pointer transition-all duration-700 border-2 border-gray-400 overflow-hidden" data-index="2" style="transform-style: preserve-3d; z-index: 100;">
          <div class="w-full h-full bg-stone-300 flex items-center justify-center text-center shadow-2xl rounded-lg category-featured overflow-hidden" style="transform-style: preserve-3d;">
            {% if section.settings.category_3_image != blank %}
              {{ section.settings.category_3_image | image_url: width: 600 | image_tag: alt: section.settings.category_3_label, class: 'category-image w-full h-full object-cover transition-transform duration-500', loading: 'eager', width: 600, height: 600, style: 'transform-style: preserve-3d;' }}
            {% else %}
              <div class="category-image text-base md:text-xl font-bold text-gray-800 transition-transform duration-500 px-4" style="transform-style: preserve-3d;">
                {{ section.settings.category_3_label }}
              </div>
            {% endif %}
          </div>
        </div>

        <!-- Item 4 -->
        <div class="carousel-item absolute w-32 md:w-40 h-40 md:h-56 rounded-lg cursor-pointer transition-all duration-700 overflow-hidden" data-index="3" style="transform-style: preserve-3d;">
          <div class="w-full h-full bg-stone-200 flex items-center justify-center text-center shadow-lg rounded-lg overflow-hidden">
            {% if section.settings.category_4_image != blank %}
              {{ section.settings.category_4_image | image_url: width: 400 | image_tag: alt: section.settings.category_4_label, class: 'w-full h-full object-cover', loading: 'lazy', width: 400, height: 400 }}
            {% else %}
              <div class="text-xs md:text-sm font-medium text-gray-700 px-4">
                {{ section.settings.category_4_label }}
              </div>
            {% endif %}
          </div>
        </div>

        <!-- Item 5 -->
        <div class="carousel-item absolute w-32 md:w-40 h-40 md:h-56 rounded-lg cursor-pointer transition-all duration-700 overflow-hidden" data-index="4" style="transform-style: preserve-3d;">
          <div class="w-full h-full bg-stone-200 flex items-center justify-center text-center shadow-lg rounded-lg overflow-hidden">
            {% if section.settings.category_5_image != blank %}
              {{ section.settings.category_5_image | image_url: width: 400 | image_tag: alt: section.settings.category_5_label, class: 'w-full h-full object-cover', loading: 'lazy', width: 400, height: 400 }}
            {% else %}
              <div class="text-xs md:text-sm font-medium text-gray-700 px-4">
                {{ section.settings.category_5_label }}
              </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>

    <!-- Controls -->
    <div class="flex justify-center gap-4 md:gap-6">
      <button id="zoom-in-btn" class="flex items-center gap-2 px-5 md:px-6 py-2 md:py-3 border-2 border-black text-black text-xs md:text-sm font-semibold uppercase hover:bg-black hover:text-white transition-colors">
        <span>üîç</span>
        Zoom In
      </button>
      <button id="rotate-btn" class="flex items-center gap-2 px-5 md:px-6 py-2 md:py-3 border-2 border-black text-black text-xs md:text-sm font-semibold uppercase hover:bg-black hover:text-white transition-colors">
        <span>‚Üª</span>
        Rotar
      </button>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const container = document.querySelector('.carousel-container');
    const items = document.querySelectorAll('.carousel-item');
    const zoomBtn = document.getElementById('zoom-in-btn');
    const rotateBtn = document.getElementById('rotate-btn');
    
    const itemCount = items.length;
    const radius = 450;
    let currentRotation = 0;
    let currentZoom = 1;
    let rotateY = 0;
    const featured = document.querySelector('.category-featured .category-image');

    function updateCarousel() {
      items.forEach((item, index) => {
        const angle = (360 / itemCount) * index + currentRotation;
        const radians = (angle * Math.PI) / 180;
        
        const x = Math.cos(radians) * radius;
        const z = Math.sin(radians) * radius;
        
        const zNormalized = (z + radius) / (radius * 2);
        const scale = 0.6 + zNormalized * 0.4;
        const opacity = 0.5 + zNormalized * 0.5;
        
        item.style.transform = `translateX(${x}px) translateZ(${z}px) scale(${scale})`;
        item.style.opacity = opacity;
        item.style.zIndex = Math.round(z);
      });
    }

    function rotateToItem(index) {
      const targetRotation = -(360 / itemCount) * index;
      currentRotation = targetRotation;
      updateCarousel();
    }

    items.forEach((item, index) => {
      item.addEventListener('click', function() {
        rotateToItem(index);
      });
    });

    if (zoomBtn && featured) {
      zoomBtn.addEventListener('click', function() {
        currentZoom = currentZoom === 1 ? 1.4 : 1;
        featured.style.transform = `scale(${currentZoom}) rotateY(${rotateY}deg)`;
      });
    }

    if (rotateBtn && featured) {
      rotateBtn.addEventListener('click', function() {
        rotateY = (rotateY + 45) % 360;
        featured.style.transform = `scale(${currentZoom}) rotateY(${rotateY}deg)`;
      });
    }

    rotateToItem(2);
  });
</script>

{% schema %}
{
  "name": "Categories Showcase",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "T√≠tulo",
      "default": "Dise√±os Unicos Y Elegantes Para Tu D√≠a AD√≠a"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subt√≠tulo",
      "default": "Soon-to-be staples in your rotation"
    },
    {
      "type": "text",
      "id": "category_1_label",
      "label": "Categor√≠a 1 - Nombre",
      "default": "Earring"
    },
    {
      "type": "image_picker",
      "id": "category_1_image",
      "label": "Categor√≠a 1 - Imagen"
    },
    {
      "type": "text",
      "id": "category_2_label",
      "label": "Categor√≠a 2 - Nombre",
      "default": "Bracelet"
    },
    {
      "type": "image_picker",
      "id": "category_2_image",
      "label": "Categor√≠a 2 - Imagen"
    },
    {
      "type": "text",
      "id": "category_3_label",
      "label": "Categor√≠a 3 - Nombre (Destacada)",
      "default": "Necklace"
    },
    {
      "type": "image_picker",
      "id": "category_3_image",
      "label": "Categor√≠a 3 - Imagen (Destacada)"
    },
    {
      "type": "text",
      "id": "category_4_label",
      "label": "Categor√≠a 4 - Nombre",
      "default": "Earring"
    },
    {
      "type": "image_picker",
      "id": "category_4_image",
      "label": "Categor√≠a 4 - Imagen"
    },
    {
      "type": "text",
      "id": "category_5_label",
      "label": "Categor√≠a 5 - Nombre",
      "default": "Accessories"
    },
    {
      "type": "image_picker",
      "id": "category_5_image",
      "label": "Categor√≠a 5 - Imagen"
    }
  ],
  "presets": [
    {
      "name": "Categories Showcase"
    }
  ]
}
{% endschema %}
