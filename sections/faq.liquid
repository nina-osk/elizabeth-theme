{% comment %}
  Secci√≥n FAQ - Preguntas Frecuentes
  Dise√±o con accordion expandible estilo Munier
{% endcomment %}

<div class="w-full bg-stone-50">
    <!-- FAQ Section -->
    <section class="py-16 md:py-20 lg:py-24">
        <div class="max-w-4xl mx-auto px-6">
            <!-- Header -->
            <div class="text-center mb-12 md:mb-16">
                <div class="flex items-center justify-center gap-2 mb-4">
                    <span class="text-2xl">‚ùì</span>
                    <p class="text-sm uppercase tracking-wider text-gray-600">
                        {{ section.settings.subtitle | default: "Resolvemos tus dudas" }}
                    </p>
                </div>
                <h1 class="text-4xl md:text-5xl lg:text-6xl font-serif text-gray-900">
                    Preguntas <span class="text-yellow-700 italic">Frecuentes</span>
                </h1>
            </div>

            {% if section.blocks.size > 0 %}
                <div class="space-y-4">
                    {% for block in section.blocks %}
                        {% if block.type == 'faq_item' %}
                            <div class="faq-item bg-white rounded-2xl shadow-sm overflow-hidden" {{ block.shopify_attributes }}>
                                <button 
                                    class="faq-question w-full text-left px-6 py-6 hover:bg-stone-50 transition-colors duration-200 flex items-center gap-4"
                                    onclick="toggleFAQ(this)"
                                    aria-expanded="false"
                                >
                                    {% if block.settings.icon != blank %}
                                        <span class="text-2xl flex-shrink-0">{{ block.settings.icon }}</span>
                                    {% endif %}
                                    <span class="text-lg md:text-xl font-normal text-gray-900 flex-1 pr-4">
                                        {{ block.settings.question }}
                                    </span>
                                    <svg class="faq-icon w-6 h-6 text-gray-400 transition-transform duration-300 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                    </svg>
                                </button>
                                <div class="faq-answer max-h-0 overflow-hidden transition-all duration-300">
                                    <div class="px-6 pb-6 pl-16 text-gray-600 leading-relaxed">
                                        {{ block.settings.answer }}
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            {% else %}
                <div class="text-center py-16">
                    <svg class="w-24 h-24 mx-auto mb-6 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <h2 class="text-2xl font-semibold text-gray-900 mb-2">
                        No hay preguntas frecuentes
                    </h2>
                    <p class="text-gray-600">
                        Agrega preguntas frecuentes desde el editor del tema
                    </p>
                </div>
            {% endif %}
        </div>
    </section>

    <!-- CTA Section -->
    {% if section.settings.show_cta %}
        <section class="bg-gray-900 py-16 md:py-20">
            <div class="max-w-4xl mx-auto px-6 text-center">
                <h2 class="text-3xl md:text-4xl font-serif text-white mb-4">
                    {{ section.settings.cta_title | default: "¬øNo encontraste tu respuesta?" }}
                </h2>
                {% if section.settings.cta_text != blank %}
                    <p class="text-xl text-white opacity-90 mb-8">
                        {{ section.settings.cta_text }}
                    </p>
                {% endif %}
                {% if section.settings.cta_button_text != blank %}
                    <a href="{{ section.settings.cta_button_link | default: '/pages/contact' }}" 
                       class="inline-block px-8 py-4 bg-white text-gray-900 font-semibold rounded-lg hover:bg-gray-100 transition-colors duration-200">
                        {{ section.settings.cta_button_text }}
                    </a>
                {% endif %}
            </div>
        </section>
    {% endif %}
</div>

<script>
function toggleFAQ(button) {
    const faqItem = button.closest('.faq-item');
    const answer = faqItem.querySelector('.faq-answer');
    const icon = faqItem.querySelector('.faq-icon');
    const isExpanded = button.getAttribute('aria-expanded') === 'true';
    
    // Cerrar todos los otros FAQs
    document.querySelectorAll('.faq-item').forEach(item => {
        if (item !== faqItem) {
            const otherAnswer = item.querySelector('.faq-answer');
            const otherIcon = item.querySelector('.faq-icon');
            const otherButton = item.querySelector('.faq-question');
            otherAnswer.style.maxHeight = '0';
            otherIcon.style.transform = 'rotate(0deg)';
            otherButton.setAttribute('aria-expanded', 'false');
        }
    });
    
    // Toggle el FAQ actual
    if (isExpanded) {
        answer.style.maxHeight = '0';
        icon.style.transform = 'rotate(0deg)';
        button.setAttribute('aria-expanded', 'false');
    } else {
        answer.style.maxHeight = answer.scrollHeight + 'px';
        icon.style.transform = 'rotate(180deg)';
        button.setAttribute('aria-expanded', 'true');
    }
}
</script>

<style>
.faq-answer {
    transition: max-height 0.3s ease-in-out;
}
</style>

{% schema %}
{
    "name": "FAQ",
    "class": "shopify-section--faq",
    "settings": [
        {
            "type": "text",
            "id": "subtitle",
            "label": "Subt√≠tulo",
            "default": "Resolvemos tus dudas"
        },
        {
            "type": "header",
            "content": "Call to Action"
        },
        {
            "type": "checkbox",
            "id": "show_cta",
            "label": "Mostrar CTA",
            "default": true
        },
        {
            "type": "text",
            "id": "cta_title",
            "label": "T√≠tulo CTA",
            "default": "¬øNo encontraste tu respuesta?"
        },
        {
            "type": "text",
            "id": "cta_text",
            "label": "Texto CTA",
            "default": "Cont√°ctanos y estaremos encantados de ayudarte"
        },
        {
            "type": "text",
            "id": "cta_button_text",
            "label": "Texto del Bot√≥n",
            "default": "Cont√°ctanos"
        },
        {
            "type": "url",
            "id": "cta_button_link",
            "label": "Link del Bot√≥n"
        }
    ],
    "blocks": [
        {
            "type": "faq_item",
            "name": "Pregunta",
            "settings": [
                {
                    "type": "text",
                    "id": "icon",
                    "label": "Icono (emoji)",
                    "info": "Usa un emoji como icono, ej: üü°, ‚ú®, üíé, üíç, ‚≠ê"
                },
                {
                    "type": "text",
                    "id": "question",
                    "label": "Pregunta",
                    "default": "¬øCu√°l es tu pregunta?"
                },
                {
                    "type": "textarea",
                    "id": "answer",
                    "label": "Respuesta",
                    "default": "Escribe aqu√≠ la respuesta a esta pregunta."
                }
            ]
        }
    ],
    "presets": [
        {
            "name": "FAQ",
            "blocks": [
                {
                    "type": "faq_item",
                    "settings": {
                        "icon": "üü°",
                        "question": "¬øQu√© es el oro 9K?",
                        "answer": "El oro de 9 kilates (9K) contiene 37.5 % de oro puro, combinado con otros metales como plata, cobre o zinc para crear una aleaci√≥n m√°s resistente. Esta composici√≥n hace que las joyas sean m√°s duraderas para el uso diario, manteniendo su forma, brillo y elegancia con el paso del tiempo."
                    }
                },
                {
                    "type": "faq_item",
                    "settings": {
                        "icon": "‚ú®",
                        "question": "¬øPuedo usar mi pieza todos los d√≠as?",
                        "answer": "S√≠, nuestras joyas est√°n dise√±adas espec√≠ficamente para el uso diario. El oro 9K es m√°s resistente que otros quilates y nuestros diamantes de laboratorio mantienen su brillo con el tiempo."
                    }
                },
                {
                    "type": "faq_item",
                    "settings": {
                        "icon": "üíé",
                        "question": "¬øSu joyer√≠a es hipoalerg√©nica?",
                        "answer": "S√≠, nuestras piezas de oro 9K son gentiles con la piel y adecuadas para personas con sensibilidad. Los materiales utilizados son de alta calidad y libres de n√≠quel."
                    }
                }
            ]
        }
    ]
}
{% endschema %}
