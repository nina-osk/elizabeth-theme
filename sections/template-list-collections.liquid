<div class="w-full bg-white py-12 md:py-16 lg:py-20">
  <div class="max-w-7xl mx-auto px-4 md:px-6 lg:px-8">
    
    <!-- Header -->
    <div style="text-align: center; margin-bottom: 3rem;">
      <p style="font-size: 0.6875rem; font-weight: 600; letter-spacing: 0.15em; color: #D4A574; margin-bottom: 1rem;">
        {{ section.settings.subtitle | default: "DESCUBRE" }}
      </p>
      <h2 style="font-family: Georgia, serif; font-size: 2.5rem; font-weight: 400; color: #2d2d2d;">
        {{ section.settings.title | default: "Coleccion" }}
      </h2>
    </div>

    <!-- Collection Filter Buttons -->
    <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 1rem; margin-bottom: 3rem;" role="tablist" aria-label="Filter by collection">
      {% for collection in collections %}
        {% if collection.all_products_count > 0 %}
          <button 
            class="collection-filter-btn"
            style="padding: 0.75rem 2.5rem; font-weight: 500; font-size: 0.8125rem; text-transform: uppercase; letter-spacing: 0.05em; transition: all 0.3s; background-color: white; color: #2d2d2d; border: 2px solid #e8e8e8; cursor: pointer;"
            data-collection-handle="{{ collection.handle }}"
            role="tab"
            aria-selected="false">
            {{ collection.title }}
          </button>
        {% endif %}
      {% endfor %}
    </div>

    <!-- Products Grid -->
    <div class="products-grid-container max-w-6xl mx-auto">
      {% for collection in collections %}
        {% if collection.all_products_count > 0 %}
          <div 
            class="collection-products-group hidden"
            data-collection-handle="{{ collection.handle }}">
            
            {% if collection.products.size > 0 %}
              <div class="collections-grid">
                {% for product in collection.products %}
                  {% render 'product-card', product: product %}
                {% endfor %}
              </div>
            {% else %}
              <!-- Empty State -->
              <div class="text-center py-16">
                <svg class="w-24 h-24 mx-auto mb-6 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path>
                </svg>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">
                  No hay productos en esta colección
                </h3>
                <p class="text-gray-600">
                  Esta colección está vacía actualmente
                </p>
              </div>
            {% endif %}
          </div>
        {% endif %}
      {% endfor %}
    </div>

  </div>
</div>

<style>
  /* Filter Button Styles */
  .collection-filter-btn {
    background-color: white;
    color: #2d2d2d;
    border: 2px solid #e8e8e8;
  }

  .collection-filter-btn.active {
    background-color: #C8A882;
    color: white;
    border: 2px solid #C8A882;
  }

  .collection-filter-btn:hover {
    background-color: #f5f5f5;
  }

  .collection-filter-btn.active:hover {
    background-color: #B89872;
  }

  /* Product Groups */
  .collection-products-group {
    opacity: 1;
    transition: opacity 0.3s ease;
  }

  .collection-products-group.hidden {
    display: none;
  }

  /* ========================================
     GRID RESPONSIVE - MÓVIL PRIMERO
     ======================================== */
  .collections-grid {
    display: grid !important;
    grid-template-columns: 1fr !important;
    gap: 0.75rem;
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
  }

  .collections-grid > * {
    min-width: 0;
    overflow: hidden;
    max-width: 100%;
    box-sizing: border-box;
  }

  /* ========================================
     MÓVIL PEQUEÑO (480px+)
     ======================================== */
  @media (min-width: 480px) {
    .collections-grid {
      grid-template-columns: 1fr !important;
      gap: 1rem !important;
    }
  }

  /* ========================================
     TABLET (768px+)
     ======================================== */
  @media (min-width: 768px) {
    .collections-grid {
      grid-template-columns: repeat(3, 1fr) !important;
      gap: 1.5rem !important;
    }
  }

  /* ========================================
     DESKTOP (1024px+)
     ======================================== */
  @media (min-width: 1024px) {
    .collections-grid {
      grid-template-columns: repeat(4, 1fr) !important;
      gap: 2rem !important;
      max-width: 100%;
      display: grid !important;
    }
  }

  /* ========================================
     DESKTOP GRANDE (1280px+)
     ======================================== */
  @media (min-width: 1280px) {
    .collections-grid {
      grid-template-columns: repeat(4, 1fr) !important;
      gap: 2.5rem !important;
    }
  }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const filterButtons = document.querySelectorAll('.collection-filter-btn');
  const productGroups = document.querySelectorAll('.collection-products-group');

  // Style constants
  const activeStyles = 'background-color: #C8A882; color: white; border-color: #C8A882;';
  const inactiveStyles = 'background-color: white; color: #2d2d2d; border-color: #e8e8e8;';

  function showCollection(handle) {
    // Update buttons
    filterButtons.forEach(btn => {
      const isActive = btn.dataset.collectionHandle === handle;
      const baseStyle = 'padding: 0.75rem 2.5rem; font-weight: 500; font-size: 0.8125rem; text-transform: uppercase; letter-spacing: 0.05em; transition: all 0.3s; border: 2px solid; cursor: pointer;';
      
      if (isActive) {
        btn.style.cssText = baseStyle + activeStyles;
        btn.setAttribute('aria-selected', 'true');
        btn.classList.add('active');
      } else {
        btn.style.cssText = baseStyle + inactiveStyles;
        btn.setAttribute('aria-selected', 'false');
        btn.classList.remove('active');
      }
    });

    // Update product groups
    productGroups.forEach(group => {
      if (group.dataset.collectionHandle === handle) {
        group.classList.remove('hidden');
      } else {
        group.classList.add('hidden');
      }
    });
  }

  // Button click handlers
  filterButtons.forEach(btn => {
    btn.addEventListener('click', function() {
      const handle = this.dataset.collectionHandle;
      showCollection(handle);
    });
  });

  // Show first collection by default
  if (filterButtons.length > 0) {
    const firstHandle = filterButtons[0].dataset.collectionHandle;
    showCollection(firstHandle);
  }
});
</script>

{% schema %}
{
    "name": "Template List Collections",
    "settings": [
        {
            "type": "text",
            "id": "subtitle",
            "label": "Subtítulo",
            "default": "DESCUBRE"
        },
        {
            "type": "text",
            "id": "title",
            "label": "Título",
            "default": "Coleccion"
        }
    ]
}
{% endschema %}